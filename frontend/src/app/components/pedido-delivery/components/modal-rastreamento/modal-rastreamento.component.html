<app-base-modal
  [aberto]="aberto()"
  [titulo]="'üìç Rastreamento - Pedido #' + (rastreamento()?.numeroPedido || '')"
  [tamanho]="'grande'"
  (onFechar)="fechar()">
  
  <div class="modal-rastreamento-conteudo">
    @if (rastreamento()?.localizacaoMotoboy?.valida) {
      <div class="status-rastreamento">
        <div class="status-item">
          <span class="status-icon">üõµ</span>
          <div class="status-info">
            <strong>Motoboy a caminho</strong>
            <small>{{ rastreamento()?.motoboyNome || 'Entregador' }}</small>
          </div>
        </div>
        <div class="status-item">
          <span class="status-icon">‚è±Ô∏è</span>
          <div class="status-info">
            <strong>√öltima atualiza√ß√£o</strong>
            <small>{{ calcularTempoDesde(rastreamento()?.localizacaoMotoboy?.timestamp) }}</small>
          </div>
        </div>
      </div>
    } @else {
      <div class="status-rastreamento">
        <div class="status-item">
          <span class="status-icon">‚è≥</span>
          <div class="status-info">
            <strong>Aguardando localiza√ß√£o</strong>
            <small>O motoboy ainda n√£o iniciou a entrega</small>
          </div>
        </div>
      </div>
    }

    <div class="mapa-container" [class.carregando]="carregandoMapa()">
      @if (carregandoMapa()) {
        <div class="mapa-carregando">
          <div class="spinner"></div>
          <p>Carregando mapa...</p>
        </div>
      }
      <div #mapContainer class="mapa-embutido"></div>
    </div>

    @if (rastreamento()?.enderecoEntrega) {
      <div class="endereco-info">
        <p class="endereco-texto">
          <strong>üìç Endere√ßo de entrega:</strong> {{ rastreamento()?.enderecoEntrega }}
        </p>
      </div>
    }

    <div class="acoes-mapa">
      <button
        type="button"
        class="btn-abrir-maps"
        (click)="abrirNoGoogleMaps()"
        [disabled]="!rastreamento()?.latitudeDestino || !rastreamento()?.longitudeDestino">
        üó∫Ô∏è Abrir no Google Maps
      </button>
      <button
        type="button"
        class="btn-fechar"
        (click)="fechar()">
        Fechar
      </button>
    </div>
  </div>
</app-base-modal>

